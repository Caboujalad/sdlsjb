<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Payments — St. Jacques Bouar</title>

  <!-- Bootstrap + Font Awesome (same as your site) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

  <style>
    /* Keep the same theme as your main site (glassmorphism nav + hero colors) */
    :root {
      --nav-bg: rgba(19, 43, 99, 0.92);
      --accent-start: #f7d794;
      --accent-end: #feca57;
      --glass-blur: 10px;
      --card-radius: 20px;
    }

    body {
      background: linear-gradient(180deg, #f8f9fa 0%, #eef2f7 100%);
      color: #222;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      padding-top: 80px; /* for fixed navbar */
    }

    /* Navbar (copied + consistent) */
    .navbar {
      background: var(--nav-bg);
      backdrop-filter: blur(var(--glass-blur));
      transition: background .4s ease;
    }
    .navbar-brand { font-weight:700; font-size:1.15rem; color:#f5f5f5 !important; }
    .nav-link { color:#ddd !important; margin:0 8px; font-weight:500; }
    .nav-link:hover { color: #f7d794 !important; }
    .nav-link.active { color: #fff !important; font-weight:700; }

    /* Page hero */
    .page-hero {
      background: linear-gradient(180deg, rgba(19,43,99,0.95), rgba(19,43,99,0.78));
      color: #fff;
      padding: 40px 0;
      text-align: center;
    }
    .page-hero h1 { font-size: 1.6rem; letter-spacing: .6px; margin-bottom:6px; }
    .page-hero p { opacity:.9; margin-bottom:0; }

    /* Form card - glassmorphism */
    .form-card {
      max-width: 760px;
      margin: -60px auto 40px;
      background: linear-gradient(180deg, rgba(255,255,255,0.95), rgba(250,250,252,0.95));
      border-radius: var(--card-radius);
      padding: 28px;
      box-shadow: 0 12px 30px rgba(8,20,40,0.12);
      border: 1px solid rgba(255,255,255,0.6);
    }

    .form-header {
      display:flex;
      gap:12px;
      align-items:center;
      margin-bottom:12px;
    }
    .form-header .icon {
      background: linear-gradient(135deg, var(--accent-start), var(--accent-end));
      padding: 12px;
      border-radius: 12px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.08);
      color: #111;
      font-size: 1.25rem;
    }

    label { font-weight:600; color: #222; }
    .form-control, .form-select, textarea { border-radius: 12px; padding: 12px 14px; }

    .btn-pay {
      background: linear-gradient(135deg, var(--accent-start), var(--accent-end));
      border: none;
      color: #111;
      font-weight:700;
      padding: 12px 18px;
      border-radius: 999px;
      box-shadow: 0 10px 24px rgba(254,196,87,0.15);
    }
    .btn-pay:active, .btn-pay:focus { transform: translateY(1px); outline: none; box-shadow: 0 6px 18px rgba(0,0,0,0.08); }

    .note { font-size: .9rem; color: #555; margin-top: 10px; }

    footer {
      background: linear-gradient(135deg, #111, #222);
      color: #ddd;
      padding: 24px 0;
      margin-top: 40px;
      text-align:center;
    }

    @media (max-width: 576px) {
      .form-card { margin: -40px 16px 24px; padding:20px; }
    }
  </style>
</head>
<body>

  <!-- Navbar (same markup as index.html, updated to include Payments) -->
  <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center" href="index.html">
        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT2CGWZC8ML3FV1sbsBcDpPJw4GvVWPsTsTeA&s" alt="Scouts Logo" width="40" height="40" class="me-2 rounded-circle">
        St. Jacques Bouar
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavPay">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarNavPay">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
          <li class="nav-item"><a class="nav-link" href="photos.html">Photos</a></li>
          <li class="nav-item"><a class="nav-link" href="maps.html">Emplacements</a></li>
          <li class="nav-item"><a class="nav-link active" href="donate.html">Payments</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Hero area -->
  <section class="page-hero">
    <div class="container">
      <h1>Payments — St. Jacques Bouar</h1>
      <p>Enter your details below. All submissions are saved to our payments sheet.</p>
    </div>
  </section>

  <!-- Form card -->
  <div class="form-card">
    <div class="form-header">
      <div class="icon"><i class="fas fa-hand-holding-dollar"></i></div>
      <div>
        <div style="font-weight:800; font-size:1.05rem;">Payment / Submission</div>
        <div style="font-size:.92rem; color:#666;">Fill name, unit, amount (USD) and an optional description.</div>
      </div>
    </div>

    <form id="paymentForm" novalidate>
      <div class="row g-3">
        <div class="col-md-6">
          <label for="name">Full name</label>
          <input id="name" class="form-control" type="text" placeholder="Your full name" required>
        </div>

        <div class="col-md-6">
          <label for="unit">Unit</label>
          <select id="unit" class="form-select" required>
            <option value="" selected disabled>Select your unit</option>
            <option>CG</option>
            <option>MDG</option>
            <option>Louvettes</option>
            <option>Louveteaux</option>
            <option>Eclaireurs</option>
            <option>Eclaireuses</option>
            <option>Clan</option>
            <option>Pionneieres</option>
          </select>
        </div>

        <div class="col-md-6">
          <label for="amount">Amount (USD)</label>
          <input id="amount" class="form-control" type="number" min="0" step="0.01" placeholder="0.00" required>
        </div>

        <div class="col-md-6">
          <label for="description">Description</label>
          <input id="description" class="form-control" type="text" placeholder="Reason or note (optional)">
        </div>

        <div class="col-12">
          <div id="statusMessage" class="note"></div>
        </div>

        <div class="col-12 d-grid">
          <button id="submitBtn" class="btn btn-pay">Submit</button>
        </div>
      </div>
    </form>

    <p class="note">All data will be stored in a Google Sheet (admin can download as Excel anytime).</p>
  </div>

  <footer>
    <p>© 2025 Scouts Du Liban - Groupe St. Jacques Bouar - 52ème Mont Liban</p>
    <div style="margin-top:8px;">
      <a href="#" class="me-3" style="color:#ddd;"><i class="fab fa-facebook-f"></i></a>
      <a href="#" class="me-3" style="color:#ddd;"><i class="fab fa-instagram"></i></a>
      <a href="#" style="color:#ddd;"><i class="fab fa-youtube"></i></a>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // =======================
    // ====== CONFIG =========
    // Replace this with your deployed Google Apps Script Web App URL (the "exec" URL)
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyTjMjmt5SSh03CulNEImK3-2vPG8PnT1Weyh05O7lqbpTxRaNdVzNXpe5ukQrJyfhE/exec";
    // =======================

    const form = document.getElementById("paymentForm");
    const statusMessage = document.getElementById("statusMessage");
    const submitBtn = document.getElementById("submitBtn");

    function setStatus(text, ok = true) {
      statusMessage.textContent = text;
      statusMessage.style.color = ok ? "green" : "red";
    }

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      setStatus("Sending...", true);
      submitBtn.disabled = true;

      const payload = {
        name: document.getElementById("name").value.trim(),
        unit: document.getElementById("unit").value,
        amount: document.getElementById("amount").value,
        description: document.getElementById("description").value.trim()
      };

      // Basic client-side validation
      if (!payload.name || !payload.unit || payload.amount === "" || isNaN(Number(payload.amount))) {
        setStatus("Please fill all required fields correctly.", false);
        submitBtn.disabled = false;
        return;
      }

      try {
        const res = await fetch(SCRIPT_URL, {
          method: "POST",
          body: JSON.stringify(payload),
          headers: { "Content-Type": "application/json" }
        });

        // If network-level failure, fetch throws. If response returned, check status or JSON
        const text = await res.text();

        // Try parse JSON if any
        let json = null;
        try { json = JSON.parse(text); } catch (_) { json = null; }

        if (res.ok && (json && json.result === "success" || text.toLowerCase().includes("success"))) {
          setStatus("✅ Submitted successfully!");
          form.reset();
        } else {
          // show exact server message if available
          const msg = (json && json.message) ? json.message : (text || "Server returned non-ok response");
          setStatus("❌ Submission failed: " + msg, false);
        }

      } catch (err) {
        // show helpful debug message
        setStatus("❌ Network or CORS error. Check the 'Script URL' and deployment settings.", false);
        console.error("Submission error:", err);
      } finally {
        submitBtn.disabled = false;
      }
    });
  </script>
</body>
</html>
